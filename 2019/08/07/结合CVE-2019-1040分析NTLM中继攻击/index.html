<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="漏洞分析,Windows,协议分析,">










<meta name="description" content="什么是NTLM中继攻击原理NTLM是Windows实现身份认证的一种协议，如计算机A远程登陆计算机B，在计算机B验证计算机A的时候使用的是NTLM协议。但是在这个过程中，计算机A在通常情况下不知道计算机B是不是真正的计算机B，因为攻击机C也可以来冒充计算机B。当攻击机C冒充计算机B后，原本计算机A发往计算机B的NTLM认证流量，将发送给攻击机C，攻击机C接收到认证信息之后，再转发给B，从而实现NT">
<meta name="keywords" content="漏洞分析,Windows,协议分析">
<meta property="og:type" content="article">
<meta property="og:title" content="结合CVE-2019-1040分析NTLM中继攻击">
<meta property="og:url" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/index.html">
<meta property="og:site_name" content="记录和分享网络安全知识">
<meta property="og:description" content="什么是NTLM中继攻击原理NTLM是Windows实现身份认证的一种协议，如计算机A远程登陆计算机B，在计算机B验证计算机A的时候使用的是NTLM协议。但是在这个过程中，计算机A在通常情况下不知道计算机B是不是真正的计算机B，因为攻击机C也可以来冒充计算机B。当攻击机C冒充计算机B后，原本计算机A发往计算机B的NTLM认证流量，将发送给攻击机C，攻击机C接收到认证信息之后，再转发给B，从而实现NT">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-6.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-5.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-7.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-8.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-9.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-10.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-11.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-12.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-13.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-14.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-16.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-16.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-17.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-2.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-3.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-4.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-5.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-6.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-7.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-8.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-9.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-10.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-11.png">
<meta property="og:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/3-1.png">
<meta property="og:updated_time" content="2019-08-08T09:47:17.690Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="结合CVE-2019-1040分析NTLM中继攻击">
<meta name="twitter:description" content="什么是NTLM中继攻击原理NTLM是Windows实现身份认证的一种协议，如计算机A远程登陆计算机B，在计算机B验证计算机A的时候使用的是NTLM协议。但是在这个过程中，计算机A在通常情况下不知道计算机B是不是真正的计算机B，因为攻击机C也可以来冒充计算机B。当攻击机C冒充计算机B后，原本计算机A发往计算机B的NTLM认证流量，将发送给攻击机C，攻击机C接收到认证信息之后，再转发给B，从而实现NT">
<meta name="twitter:image" content="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-6.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/">





  <title>结合CVE-2019-1040分析NTLM中继攻击 | 记录和分享网络安全知识</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">记录和分享网络安全知识</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">lahonja's Blog</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://lahonja.site/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LAHONJA">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="记录和分享网络安全知识">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">结合CVE-2019-1040分析NTLM中继攻击</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-07T10:41:52+08:00">
                2019-08-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/内网渗透/" itemprop="url" rel="index">
                    <span itemprop="name">内网渗透</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count gitment-comments-count" data-xid="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  4.8k
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="什么是NTLM中继攻击"><a href="#什么是NTLM中继攻击" class="headerlink" title="什么是NTLM中继攻击"></a>什么是NTLM中继攻击</h2><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>NTLM是Windows实现身份认证的一种协议，如计算机A远程登陆计算机B，在计算机B验证计算机A的时候使用的是NTLM协议。但是在这个过程中，计算机A在通常情况下不知道计算机B是不是真正的计算机B，因为攻击机C也可以来冒充计算机B。当攻击机C冒充计算机B后，原本计算机A发往计算机B的NTLM认证流量，将发送给攻击机C，攻击机C接收到认证信息之后，再转发给B，从而实现NTLM流量的中继，也就是平常所说的中间人攻击，NTLM中继也就是中间人攻击的一种。<br>上述过程我们可以将再攻击机C上的中继程序理解为一个NTLM协议代理程序。但是攻击机C怎么实现欺骗计算机A呢，许多网络协议可以用来进行欺骗，从而进行中间人攻击，常见的有ARP、DHCP、DNS等。在实际的攻击中，使用LLMNR/NetBIOSNS欺骗的方式更多，因为这类欺骗的网络流量小，实施也更容易，与Net-NTLMhash relay attack的结合也更紧密。<br>LLMNR和NetBIOSNS是Windows系统完成名称解析的一种方法。<br><strong>Windows系统对机器名的解析顺序如下：</strong></p>
<ol>
<li>本地HOSTS文件（%windir%\System32\drivers\etc\hosts）</li>
<li>DNS缓存</li>
<li>DNS服务器</li>
<li>链路本地多播名称解析（LLMNR）</li>
<li>NetBIOS名称服务（NBT-NS）</li>
</ol>
<blockquote>
<p><a href="https://dirkjanm.io/abusing-exchange-one-api-call-away-from-domain-admin/" target="_blank" rel="noopener">参考文档</a></p>
</blockquote>
<h3 id="LLMNR协议"><a href="#LLMNR协议" class="headerlink" title="LLMNR协议"></a>LLMNR协议</h3><p>在DNS 服务器不可用时，DNS 客户端计算机可以使用本地链路多播名称解析 (LLMNR—Link-Local Multicast Name Resolution)（也称为多播 DNS 或 mDNS）来解析本地网段上的名称。例如，如果路由器出现故障，从网络上的所有 DNS 服务器切断了子网，则支持 LLMNR 的子网上的客户端可以继续在对等基础上解析名称，直到网络连接还原为止。</p>
<a id="more"></a>
<ol>
<li>主机在自己的内部名称缓存中查询名称。如果在缓存中没有找到，那么主机就会向自己配置的主DNS服务器发送查询请求。如果没有收到回应或收到了错误信息，主机还会尝试搜索配置的备用DNS服务器。如果主机没有配置DNS服务器，或者如果在连接DNS服务器的时候没有遇到错误但失败了，那么名称解析会失败，并转为使用LLMNR。</li>
<li>主机通过用户数据报协议(UDP)发送多播查询，查询主机名对应的IP地址，这个查询会被限制在本地子网(也就是所谓的链路局部)内。</li>
<li>链路局部范围内每台支持LLMNR，并且被配置为响应传入查询的主机，在收到这个查询请求后，会将被查询的名称和自己的主机名进行比较。如果没有找到匹配的主机名，那么计算机就会丢弃这个查询。如果找到了匹配的主机名，这台计算机会传输一条包含了自己IP地址的单播信息给请求该查询的主机。<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-6.png">

</li>
</ol>
<h3 id="LLMNR利用方式"><a href="#LLMNR利用方式" class="headerlink" title="LLMNR利用方式"></a>LLMNR利用方式</h3><p>通过LLMNR欺骗，让计算机A认为攻击机C就是计算机B。然后将计算机A将NTLM认证发送给攻击机C，攻击机C对流量进行解析和转发。</p>
<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-5.png">
<blockquote>
<p><a href="https://pentest.blog/what-is-llmnr-wpad-and-how-to-abuse-them-during-pentest/" target="_blank" rel="noopener">参考文档</a></p>
</blockquote>
<h3 id="WPAD"><a href="#WPAD" class="headerlink" title="WPAD"></a>WPAD</h3><p>网络代理自动发现协议WPAD（Web Proxy Auto-Discovery Protocol） 是 Web 代理自动发现协议的简称，该协议的功能是可以使局域网中用户的浏览器可以自动发现内网中的代理服务器，并使用已发现的代理服务器连接互联网或者企业内网。当系统开启了代理自动发现功能后，用户使用浏览器上网时，浏览器就会在当前局域网中自动查找代理服务器，如果找到了代理服务器，则会从代理服务器中下载一个名为 PAC（Proxy Auto-Config） 的配置文件。该文件中定义了用户在访问一个 URL 时所应该使用的代理服务器。浏览器会下载并解析该PAC文件，并将相应的代理服务器设置到用户的浏览器中。PAC文件指定攻击者就是代理服务器，然后攻击者就可以劫持受害者的HTTP流量，在其中插入任意HTML标签。</p>
<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-7.png">
<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-8.png">
<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-9.png">

<h3 id="WPAD利用方式"><a href="#WPAD利用方式" class="headerlink" title="WPAD利用方式"></a>WPAD利用方式</h3><p>前面讲到的LLMNR利用方式是直接中继整个计算机A的所有流量，但是WPAD这种方式只能中继浏览器的HTTP流量。那么这种情况下如何才能获取到SMB的流量呢？<br><strong>这里重点分析下浏览器在什么情况下可以自动向攻击者发送Net-NTLMhash。</strong><br>下图是几款浏览器对WPAD及SMB支持的情况：</p>
<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-10.png">
<p>我们可以看出，Windows10上的IE和Edge，即使支持SMB协议，但是无法通过劫持WPAD的方式来触发，Chrome浏览器虽然可以进行WPAD劫持，但是不支持SMB协议。<br>一个解决思路就是放弃最常用的NTLMSSP over SMB，使用NTMLSSP over HTTP，使用HTTP协议来发送NTLM认证消息：</p>
<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-11.png">
<p>那接下来的问题就是浏览器什么情况下会通过HTTP协议自动发送Net-NTLMhash呢？答案是IntranetZone</p>
<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-12.png">
<p>通过对IE上述配置的分析，发现配置与注册表中的policy和zone有关：如果policy是URLPOLICY_CREDENTIALS_SILENT_LOGON_OK，IE会自动发送Net-NTLMhash。如果policy是URLPOLICY_CREDENTIALS_MUST_PROMPT_USER，那么只有zone的值为0、1、2的时候才会自动发送Net-NTLMhash。</p>
<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-13.png">
<p>经过测试，在Windows10上，工作组环境下，只要URL是主机名而不是完全限定性域名的情况下，就认为是LocalInternet Zone内的，如下图：</p>
<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-14.png">
<blockquote>
<p><a href="https://pentest.blog/what-is-llmnr-wpad-and-how-to-abuse-them-during-pentest/" target="_blank" rel="noopener">参考文档</a></p>
</blockquote>
<h3 id="DHCP"><a href="#DHCP" class="headerlink" title="DHCP"></a>DHCP</h3><p>DHCP Sproofing同样是一种中间人攻击方式。DHCP是提供IP地址分配的服务。当局域网中的计算机设置为自动获取IP，就会在启动后发送广播包请求IP地址。DHCP服务器（如路由器）会分配一个IP地址给计算机。在分配的时候，会提供DNS服务器地址。<br>攻击者可以通过伪造大量的IP请求包，而消耗掉现有DHCP服务器的IP资源。当有计算机请求IP的时候，DHCP服务器就无法分配IP。如果攻击者分配假的网关，并把网关指向一台攻击主机，攻击主机再把网络流量转发给真正的网关，这样虽然不影响用户正常的上网，但客户机的所有流量都流经攻击主机，很容易泄露一些机密信息，这种攻击也叫中间人攻击。攻击者还可以在给计算机分配IP时，指定一个虚假的DNS服务器地址。这时，当用户访问网站的时候，就被虚假DNS服务器引导到错误的网站。</p>
<h3 id="IPv6"><a href="#IPv6" class="headerlink" title="IPv6"></a>IPv6</h3><p>从Windows Vista之后，每台Windows计算机都默认定期请求此配置信息，你可以从Wireshark抓取的数据包看到：</p>
<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-16.png">
<p>通过响应这些DHCPv6请求，为受害主机分配本地链路范围内的IPv6地址。而实际上，在IPv6网络中，这些地址由主机自动分配，不需要由DHCP服务器配置。这使得我们有机会将我们的IP设置为默认IPv6 DNS服务器。为了完成上述操作，一般使用的工具为MITM6。<br>MITM6不会对网络中所有流量进行中间人劫持，而是只针对目标主机，所以它对网络的影响很小。<br>MITM6是一款测试工具，它利用Windows的默认配置来接管默认的DNS服务器。通过响应DHCPv6消息，为受害者提供链路本地IPv6地址，并将攻击者主机设置为默认DNS服务器来实现此目的。作为DNS服务器，mitm6将有选择地响应攻击者选择的DNS查询，并将受害者流量重定向到攻击者主机，而不是合法服务器。</p>
<h3 id="IPv6利用方式"><a href="#IPv6利用方式" class="headerlink" title="IPv6利用方式"></a>IPv6利用方式</h3><p>MITM6的攻击过程如下图所示。它自动检测攻击者主机的IP配置，应答本网络内客户端发送的DHCPv6请求报文，然后指定攻击者的IP为DNS服务器地址。它还有一个可选功能，即周期性地发送RA（Router Advertisment）报文，提醒客户端当前环境中存在一个IPv6网络，需要通过DHCPv6协议获取IPv6地址。</p>
<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-16.png">
<p>在受害主机上，你可以看到我们的服务器被配置为DNS服务器。由于Windows对IP协议的偏好，IPv6 DNS服务器的优先级高于IPv4 DNS服务器，因此IPv6 DNS服务器将用于查询A（IPv4）和AAAA（IPv6）记录。</p>
<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/1-17.png">

<h2 id="NTLM协议介绍"><a href="#NTLM协议介绍" class="headerlink" title="NTLM协议介绍"></a>NTLM协议介绍</h2><h3 id="协议介绍"><a href="#协议介绍" class="headerlink" title="协议介绍"></a>协议介绍</h3><p>NTLM是Windows上对于SSPI身份认证接口的一种实现。<br>在Windows上，微软定义了一套用于安全认证相关的接口-SSPI，全称为 Security Service Provider Interface。这套接口定义了与安全有关的功能函数，包含但不限于：</p>
<ol>
<li>身份验证机制</li>
<li>为其他协议提供的 Session security 机制。Session Security 指的是会话安全，即为通讯提供数据完整性校验以及数据的加、解密功能。</li>
</ol>
<p>因为 SSPI 中定义了与 session security 有关的 API。所以，基本上层应用利用任何 SSP 与远程的服务进行了身份验证后，此 SSP 都会为本次连接生成一个随机 key。这个 key 往往被称为 Session Key。上层应用在经过身份验证后，可以选择性地使用这个 Key 来对之后发往服务端或接收自服务端的数据进行签名或加密。<br>不同的 SSP，实现的身份验证机制是不一样的。比如 NTLM 实现的就是一种 Challenge Based 身份验证机制。而 Kerberos 实现的就是基于 ticket 的身份验证机制。我们可以编写自己的 SSP，然后注册到操作系统中，让操作系统支持更多的自定义的身份验证方法。</p>
<h3 id="认证流程"><a href="#认证流程" class="headerlink" title="认证流程"></a>认证流程</h3><img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-2.png">

<ul>
<li>SMB2 / Negotiate Protocol</li>
</ul>
<ol>
<li>Negotiate Protocol Request: 客户端向服务端发送SMB_COM_NEGOTIATE Request请求消息，进行协商要使用的协议版本。<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-3.png"></li>
<li>Negotiate Protocol Response: 服务器收到该请求后，选择一个它支持的最新版本，再通过SMB_COM_NEGOTIATE Response回复给客户端。这里选择的是SMBv2.???，所以还需进一步协商版本号：<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-4.png">
响应中的Dialect于选择的协议对应关系：<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-5.png">
进行第二次版本号协商：<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-6.png">
回应选择的版本号为0x0311:<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-7.png">
</li>
</ol>
<ul>
<li>SMB2 / Session Setup</li>
</ul>
<ol start="3">
<li>Session Setup Request: Negotiate Protocol阶段结束之后，客户端发送SMB_COM_SESSION_SETUP_ANDX请求消息。 如果协商结果是使用NTLM进行身份验证，则在此消息中嵌入NTLM NEGOTIATE_MESSAGE。<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-8.png"></li>
<li>Session Setup Response: 服务器响应SMB_COM_SESSION_SETUP_ANDX响应消息，其中嵌入了NTLM CHALLENGE_MESSAGE。 该消息包括一个8字节的随机数，称为Challenge，服务器在消息的ServerChallenge字段中生成并发送。<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-9.png"></li>
<li>Session Setup Request: 客户端从NTLM CHALLENGE_MESSAGE中提取ServerChallenge字段，使用Challenge与客户端账号密码的NTLM hash进行加密运算，生成NET-NTLM，并将NTLM AUTHENTICATE_MESSAGE发送到服务器（嵌入在SMB_COM_SESSION_SETUP_ANDX请求消息中）。<strong>注意下图中绿色方框中的内容，将会是CVE-2019-1040漏洞的关键点。</strong><img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-10.png"></li>
<li>Session Setup Response: 如果账户及密码服务器发送嵌入在SMB_COM_SESSION_SETUP_ANDX响应消息中的成功或失败的消息（下图是失败）。<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/2-11.png">

</li>
</ol>
<h3 id="NTLM-Hash-Vs-NET-NTLM-Hash"><a href="#NTLM-Hash-Vs-NET-NTLM-Hash" class="headerlink" title="NTLM Hash Vs NET-NTLM Hash"></a>NTLM Hash Vs NET-NTLM Hash</h3><p>通常可从Windows系统中的SAM文件和域控的NTDS.dit文件中获得所有用户的NTLM hash，通过Mimikatz读取lsass.exe进程能获得已登录用户的NTLM hash，格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aad3b435b51404eeaad3b435b51404ee:e19ccf75ee54e06b06a5907af13cef42</span><br></pre></td></tr></table></figure>

<p>Net—NTLM的hash是用于网络认证(他们的基于用户NT的hash值通过响应的算法产生的)。一般是Net-NTLM v1 hash，Net-NTLM v2 hash的统称。Net-NTLMv2的格式如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin::N46iSNekpT:08ca45b7d7ea58ee:88dcbe4446168966a153a0064958dac6:5c7830315c7830310000000000000b45c67103d07d7b95acd12ffa11230e0000000052920b85f78d013c31cdb3b92f5d765c783030</span><br></pre></td></tr></table></figure>

<p>渗透测试过程中，可以通过域控制器的NTDS数据库进而得到NTLM hash，或者通过Hash导出工具得到用户NTLM hash，但是不可以通过这种方法得到Net-NTLM的hash值。当拿到NTLM hash后，可以通过拿到的NTLM hash进行Pass the hash(PTH)攻击。</p>
<h2 id="NTLM中继攻击实验"><a href="#NTLM中继攻击实验" class="headerlink" title="NTLM中继攻击实验"></a>NTLM中继攻击实验</h2><h3 id="LDAP签名绕过"><a href="#LDAP签名绕过" class="headerlink" title="LDAP签名绕过"></a>LDAP签名绕过</h3><p>默认情况下，SMB中的NTLM身份验证:NEGOTIATE_SIGN为set状态：</p>
<img src="/2019/08/07/结合CVE-2019-1040分析NTLM中继攻击/3-1.png">
<p>将此SMB流量中继到LDAP时，由于此时的Negotiate Sign设置为set，该标志会触发LDAP签名，而此SMB流量为攻击者从Exchange服务器上中继而来，无法通过LDAP的签名校验，从而被LDAP忽略，导致攻击失败。为了防止攻击失败，需要将NEGOTIATE_SIGN设置为Not set。为了确保消息在传输中不被篡改，NTML协议在NTLM_AUTHENTICATE消息中添加了一个额外的MIC（消息完整性代码）字段。如果简单的改包，将NEGOTIATE_SIGN设置Not set，将会导致MIC校验不通过。<br>因此，试图篡改其中一条消息的攻击者（例如，修改签名协商）将无法生成相应的MIC，这将导致攻击失败。<br>接下来就是绕过MIC校验的方式，以便更改包中NEGOTIATE_SIGN的值。<br>LDAP签名绕过方法：</p>
<ol>
<li>取消设置NTLM_NEGOTIATE消息中的签名标志 NTLMSSP_NEGOTIATE_ALWAYS_SIGN，NTLMSSP_NEGOTIATE_SIGN</li>
<li>取消设置NTLM_AUTHENTICATE消息中的以下标志 NTLMSSP_NEGOTIATE_ALWAYS_SIGN，NTLMSSP_NEGOTIATE_SIGN，NEGOTIATE_KEY_EXCHANGE，NEGOTIATE_VERSION</li>
</ol>
<h3 id="MIC校验绕过"><a href="#MIC校验绕过" class="headerlink" title="MIC校验绕过"></a>MIC校验绕过</h3><p>Microsoft服务器允许无MIC 的NTLM_AUTHENTICATE消息。如果想要将SMB身份验证中继到LDAP，并完成中继攻击。取消MIC校验以确保可以修改数据包中的内容：</p>
<ol>
<li>从NTLM_AUTHENTICATE消息中删除MIC</li>
<li>从NTLM_AUTHENTICATE消息中删除版本字段（删除MIC字段而不删除版本字段将导致错误）</li>
</ol>
<h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p>获得其他计算机的身份认证会话信息，以其他计算机的权限去访问远程资源，权限取决于中间人攻击时捕获到的SMB身份认证。</p>
<h3 id="利用过程"><a href="#利用过程" class="headerlink" title="利用过程"></a>利用过程</h3><p>未完待续</p>
<h3 id="如何防御"><a href="#如何防御" class="headerlink" title="如何防御"></a>如何防御</h3><p>SMB-Relay可以通过开启SMB Signing（SMB签名）来进行防御。<br>SSP 往往会为上层协议提供 session security 功能，NTLM SSP 也不例外。session security 功能往往都是基于 session key 来实现的。这个 session key 往往是由 SSP 自己生成的。（Kerberos 场景下，session key 是由 KDC 在生成相应票据的时候一起生成的，并发回给客户端或服务端的）。<br>在开启了 SMB签名 的情况下，在SMB协议使用 NTLM SSP 进行了身份验证后，后续的所有数据包，都会利用 NTLM SSP 生成的这个 session key 进行签名。SMB服务端收到后续的数据包后，也会检查数据包的签名，如果签名不对，则拒收。<br>NTLM SSP 在生成 session key 的时候，会需要用到账号密码的原始 LM HASH 或 NT HASH。而中继类型的攻击，都是站在一个中间人的位置，是不可能知道原始的LM HASH或NT HASH的（如果知道了也就不需要中继攻击这种攻击手法了，就可以PTH了）。我们是无法计算出来这个session key的，自然也就无法对数据包进行签名。（有一个例外，NETLOGON 协议的 CVE 2015-0005）。<br>所以在用 SMB-Relay 打一台服务器的时候，如果出现了账号验证成功，但是后续无法进行任何其他操作的时候，或者提示Access denied的时候，这就是目标服务器开启了 SMB 签名校验。<br>通过开启 SMB Signing 功能，才能防止 SMB-Relay。这实际上是 NTLM SSP 的一个缺陷。仔细观察前面所讲到的 NTLM 验证流程可以发现，NTLM SSP 可以让服务端来验证客户端的身份，但是却无法让客户端来验证服务端的身份。也就是说，使用 NTLM SSP 的客户端，本质上是不知道自己连上的服务器到底是哪一台的。Kerberos 是支持双向认证的。（支持双向验证的 SSP ，一般都是在验证阶段就引入了 session key 或其他类似的 key，来确保进行验证的双方都知道所谓的 “previously-shared secret”。在 NTLM SSP 中，这个 previously-shared secret 指的就是 LM HASH 或 NT HASH）。<br>所以，要想解决 NTLM-Relay 的问题，只能是使用 NTLM SSP 的上层协议，强行使用类似 SMB-Signing（如 LDAP Signing） 的手法，来间接验证服务端的身份。<br>域环境下默认的验证协议是 Kerberos。（本质上是进行 Negotiate 协商，它会优先选择 Kerberos）但是当 Kerberos 因为某些原因不可用的时候，会降级到 NTLM。</p>
<h2 id="CVE-2019-1040分析"><a href="#CVE-2019-1040分析" class="headerlink" title="CVE-2019-1040分析"></a>CVE-2019-1040分析</h2><h3 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h3><p>未完待续</p>
<p>如果Exchange等Windows服务器可以向我们进行身份验证，并通过LDAP将该身份验证中继到域控制器，则可以获得受害者的权限并在Active Directory中执行各种操作。在Exchange的情况下，这导致了黑客拥有足够高的权限来授予自己DCSync权限，这是PrivExchange漏洞产生的原因。<br>SpoolService/printer bug<br>在攻击利用流程中，需要使用到一个名为printerbug.py的工具，此工具触发SpoolService/printer bug，强制Windows主机通过MS-RPRN RPC接口向攻击者进行身份验证。<br>Windows的MS-RPRN协议用于打印客户机和打印服务器之间的通信，默认情况下是启用的。协议定义的RpcRemoteFindFirstPrinterChangeNotificationEx()调用创建一个远程更改通知对象，该对象监视对打印机对象的更改，并将更改通知发送到打印客户端。<br>任何经过身份验证的域成员都可以连接到远程服务器的打印服务（spoolsv.exe），并请求对一个新的打印作业进行更新，令其将该通知发送给指定目标。之后它会将立即测试该连接，即向指定目标进行身份验证（攻击者可以选择通过Kerberos或NTLM进行验证）。另外微软表示这个bug是系统设计特点，无需修复。</p>
<h3 id="利用过程-1"><a href="#利用过程-1" class="headerlink" title="利用过程"></a>利用过程</h3><p>未完待续</p>
<p>使用AD帐户，通过SMB连接到受害者Exchange服务器，并触发SpoolService错误。 攻击者服务器将通过SMB连接，并使用修改后的ntlmrelayx版本中继到LDAP。 使用中继的LDAP身份验证，为攻击者帐户授予DCSync权限。 攻击者帐户现在可以使用DCSync转储AD中的所有密码哈希值。<br>使用AD帐户，通过SMB连接到受害者Exchange服务器，并触发SpoolService错误。 攻击者服务器将通过SMB连接，并使用修改后的ntlmrelayx版本中继到LDAP。 使用中继的LDAP身份验证，将受害者服务器的基于资源的约束委派权限授予攻击者控制下的计算机帐户。 攻击者现在可以作为受害者服务器上的任何用户进行身份验证。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/漏洞分析/" rel="tag"># 漏洞分析</a>
          
            <a href="/tags/Windows/" rel="tag"># Windows</a>
          
            <a href="/tags/协议分析/" rel="tag"># 协议分析</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/08/05/结合ms14068对kerberos协议分析/" rel="next" title="结合ms14068对kerberos协议分析">
                <i class="fa fa-chevron-left"></i> 结合ms14068对kerberos协议分析
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/08/07/总结一些Linux后门及取证方法/" rel="prev" title="总结一些Linux后门及取证方法">
                总结一些Linux后门及取证方法 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      
        <div id="gitment-container"></div>
      
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">LAHONJA</p>
              <p class="site-description motion-element" itemprop="description">网络安全 CTF 内网渗透 取证分析</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            
            <br>
            <br>
            <div class="site-state-item site-state-posts" style="border-left:none;">
                  <span class="site-state-item-count" id="busuanzi_value_site_pv"></span>
                  <span class="site-state-item-name">浏览量</span>
            </div>
            <div class="site-state-item site-state-posts">
                  <span class="site-state-item-count" id="busuanzi_value_site_uv"></span>
                <span class="site-state-item-name">访客量</span>
            </div>
            <div class="site-state-item site-state-posts">
                  <span class="site-state-item-count">13.8k</span>
                  <span class="site-state-item-name">总字数</span>
            </div>
          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是NTLM中继攻击"><span class="nav-number">1.</span> <span class="nav-text">什么是NTLM中继攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#原理"><span class="nav-number">1.1.</span> <span class="nav-text">原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LLMNR协议"><span class="nav-number">1.2.</span> <span class="nav-text">LLMNR协议</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LLMNR利用方式"><span class="nav-number">1.3.</span> <span class="nav-text">LLMNR利用方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WPAD"><span class="nav-number">1.4.</span> <span class="nav-text">WPAD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WPAD利用方式"><span class="nav-number">1.5.</span> <span class="nav-text">WPAD利用方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DHCP"><span class="nav-number">1.6.</span> <span class="nav-text">DHCP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IPv6"><span class="nav-number">1.7.</span> <span class="nav-text">IPv6</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IPv6利用方式"><span class="nav-number">1.8.</span> <span class="nav-text">IPv6利用方式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NTLM协议介绍"><span class="nav-number">2.</span> <span class="nav-text">NTLM协议介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#协议介绍"><span class="nav-number">2.1.</span> <span class="nav-text">协议介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#认证流程"><span class="nav-number">2.2.</span> <span class="nav-text">认证流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NTLM-Hash-Vs-NET-NTLM-Hash"><span class="nav-number">2.3.</span> <span class="nav-text">NTLM Hash Vs NET-NTLM Hash</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NTLM中继攻击实验"><span class="nav-number">3.</span> <span class="nav-text">NTLM中继攻击实验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#LDAP签名绕过"><span class="nav-number">3.1.</span> <span class="nav-text">LDAP签名绕过</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MIC校验绕过"><span class="nav-number">3.2.</span> <span class="nav-text">MIC校验绕过</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#效果"><span class="nav-number">3.3.</span> <span class="nav-text">效果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#利用过程"><span class="nav-number">3.4.</span> <span class="nav-text">利用过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何防御"><span class="nav-number">3.5.</span> <span class="nav-text">如何防御</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CVE-2019-1040分析"><span class="nav-number">4.</span> <span class="nav-text">CVE-2019-1040分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#漏洞原理"><span class="nav-number">4.1.</span> <span class="nav-text">漏洞原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#利用过程-1"><span class="nav-number">4.2.</span> <span class="nav-text">利用过程</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LAHONJA</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  







<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    
      <style>
        a.gitment-editor-footer-tip { display: none; }
        .gitment-container.gitment-footer-container { display: none; }
      </style>
    

    
      <script type="text/javascript">
      function renderGitment(){
        var gitment = new Gitmint({
            id: '1565145712000', 
            owner: 'lahonja',
            repo: 'lahonja-gitment',
            
            lang: "" || navigator.language || navigator.systemLanguage || navigator.userLanguage,
            
            oauth: {
            
            
                client_secret: 'da95862b3f011a7014c03ca9390abcaaf69fd37b',
            
                client_id: 'be29a1cd496db3f72d7b'
            }});
        gitment.render('gitment-container');
      }

      
      renderGitment();
      
      </script>
    







  





  

  

  

  
  

  

  

  

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</body>
</html>
